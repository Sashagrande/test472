**Тестовое задание Backend**

Разработать асинхронный сервер, отправляющий в вебсокет текущие значения валютных пар.

**Получение и хранение точек**

Получаем и храним в памяти точки. Точка - это id актива, timestamp время и value - стоимость актива (валютной пары).

Завести список активов (базу данных выбираете на свое усмотрение)



|id|symbol|
| - | - |
|1|EURUSD|
|2|USDJPY|
|3|GBPUSD|
|4|AUDUSD|
|5|USDCAD|

Котировки получаем, совершая get-запрос каждую секунду:

https://rates.emcont.com/

Активов приходит больше чем надо, берем только EURUSD, USDJPY, GBPUSD, AUDUSD, USDCAD.

Из полученного json’a взять поля bid и ask, у нас за значение котировки будет принято среднее арифметическое между bid и ask:

*value = (bid+ask)2*

Точки нужно хранить в БД и при запросе отдавать точки за последние 30 минут. Таким образом по каждому активу будет массив точек.

**Отдача точек клиентам**

Наружу выставить вебсокет на порте 8080.

1 Клиент, подключившийся к сокету может запросить активы, отправив сообщение

*{"action":"assets","message":{}}*

В ответ сервер присылает массив активов:

*{"action":"assets","message":{"assets":[{"id":1,"name":"EURUSD"},{"id":2,"name":"USDJPY"},{"id":3,"nam e":"GBPUSD"},{"id":4,"name":"AUDUSD"},{"id":5,"name":"USDCAD"}]}}*

*2* Для подписки на котировки выбранного актива клиент отправляет сообщение:

*{"action":"subscribe","message":{"assetId":1}}*

После подписки на актив сервер присылает точки за последние 30 минут и каждую новую точку. Клиент единовременно может быть подписан только на 1 актив (то есть если присылают subscribe еще раз, то сокет перещелкивается на новый актив)

Пример истории (сокращена для экономии места):

*{"message":{"points":[{"assetName":"EURUSD","time":1455883484,"assetId":1,"value":1.110481 },{"assetName":"EURUSD","time":1455883485,"assetId":1,"value":1.110948},{"assetName":"EU RUSD","time":1455883486,"assetId":1,"value":1.111122}]},"action":"asset\_history"}*

Json новой точки: *{"message":{"assetName":"EURUSD","time":1453556718,"assetId":1,"value":1.079755},"action":"point"}*
